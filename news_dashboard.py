import streamlit as st
import feedparser
import ssl
from datetime import datetime, timedelta
from dateutil import parser # ë‚ ì§œ ê³„ì‚°ìš©

# ---------------------------------------------------------
# 1. íšŒì‚¬ ë³´ì•ˆë§(SSL) ìš°íšŒ ì„¤ì • (í•„ìˆ˜!)
# ---------------------------------------------------------
if hasattr(ssl, '_create_unverified_context'):
    ssl._create_default_https_context = ssl._create_unverified_context

# ---------------------------------------------------------
# 2. í˜ì´ì§€ ì„¤ì •
# ---------------------------------------------------------
st.set_page_config(
    page_title="ì˜ì—…ìš© ë‰´ìŠ¤ ìˆ˜ì§‘ê¸°",
    page_icon="ğŸ“°",
    layout="wide"
)

st.title("ğŸ“° B2B ì˜ì—… ì´ìŠˆ & ë‰´ìŠ¤ ëª¨ë‹ˆí„°ë§")
st.markdown("í˜„ëŒ€ë¦¬ë°”íŠ¸ ì˜ì—…ë§¨ì„ ìœ„í•œ **ì‹¤ì‹œê°„ ë‰´ìŠ¤ ìë™ ìˆ˜ì§‘ê¸°** (Feat. ë³´ì•ˆ ëš«ìŒ)")

# ---------------------------------------------------------
# 3. ì‚¬ì´ë“œë°” ì„¤ì • (ì—¬ê¸°ê°€ ë‹ˆê°€ ì°¾ë˜ ë¶€ë¶„!)
# ---------------------------------------------------------
st.sidebar.header("ğŸ› ï¸ ê²€ìƒ‰ ì¡°ê±´ ì„¤ì •")

# (1) í‚¤ì›Œë“œ ì…ë ¥ì°½ (ë‹ˆê°€ ì›í•˜ë˜ ê¸°ëŠ¥!)
default_keywords = "í˜¸í…” ë¦¬ëª¨ë¸ë§, ê±´ìì¬ ê°€ê²©, ê±´ì„¤ì—… ì „ë§, í˜„ëŒ€ë¦¬ë°”íŠ¸, í•œìƒ˜ B2B, ì‹ ê·œ ë¦¬ì¡°íŠ¸"
user_input = st.sidebar.text_area(
    "ê²€ìƒ‰í•  í‚¤ì›Œë“œ (ì½¤ë§ˆ , ë¡œ êµ¬ë¶„)", 
    value=default_keywords,
    height=100
)
# ì½¤ë§ˆë¡œ ì˜ë¼ì„œ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜
keywords = [k.strip() for k in user_input.split(',') if k.strip()]

# (2) ê¸°ê°„ í•„í„°ë§
period_option = st.sidebar.selectbox(
    "ì¡°íšŒ ê¸°ê°„",
    ["ì „ì²´ ë³´ê¸°", "ìµœê·¼ 24ì‹œê°„", "ìµœê·¼ 3ì¼", "ìµœê·¼ 1ì£¼ì¼"]
)

st.sidebar.info(f"í˜„ì¬
